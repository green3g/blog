<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="author" content="roemhildtg"> 
    <link rel="canonical" href="http://roemhildtg.github.io/Ramblings/2015/January/ArcMap Metadata Update/"> 
    <link rel="shortcut icon" href="../../../../img/favicon.ico">

    <title>ArcMap Metadata Update - Thoughts and Ramblings</title>

    <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../../css/base.css" rel="stylesheet">
    <link href="../../../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../../..">Thoughts and Ramblings</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Ramblings <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../">Home</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">2015</a>
    <ul class="dropdown-menu">
        
            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">January</a>
    <ul class="dropdown-menu">
        
            
<li class="active">
    <a href="./">ArcMap Metadata Update</a>
</li>

        
            
<li >
    <a href="../Install Skype In OpenSUSE/">Install Skype In OpenSUSE</a>
</li>

        
            
<li >
    <a href="../MP495 Install Linux/">MP495 Install Linux</a>
</li>

        
            
<li >
    <a href="../Quick Media Center/">Quick Media Center</a>
</li>

        
            
<li >
    <a href="../Sharepoint Scroll Bug/">Sharepoint Scroll Bug</a>
</li>

        
    </ul>
  </li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">2016</a>
    <ul class="dropdown-menu">
        
            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">January</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../2016/January/Long File Names/">Long File Names</a>
</li>

        
    </ul>
  </li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../../../">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../Install Skype In OpenSUSE/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="http://github.com/roemhildtg/blog">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#arcmap-update-layer-descriptions-to-stored-metadata">ArcMap Update Layer Descriptions to Stored Metadata</a></li>
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="arcmap-update-layer-descriptions-to-stored-metadata">ArcMap Update Layer Descriptions to Stored Metadata</h1>
<p>ArcGIS Server stores a lot of information about each layer, including SOME of the metadata that is kept in an ArcGIS shapefile, or database feature class. The reason I say some, is that only the Description of the metadata is actually stored in the layer in the mxd, and that is the only text that gets published. In addition to this problem, the metadata is not automatically updated in an mxd when you edit the metadata in the feature class, and the only way to update that metadata description is to remove the layer from the mxd, and re-add it. Or you can do it manually with a script.</p>
<p>The script below iterates through each layer in the current mxd and exports the metadata to an xml. This is necessary since ArcPy doesn't have direct access to the metadata. Then it parses the xml document, and searches for the 'abstract', 'purpose', and 'credit', creates a nice looking string and sets the layer description to that string. The script can easily be modified to include less or more depending on your metadata. It may not work for all metadata types, but it worked for our setup.</p>
<pre><code class="python">import arcpy,xml #set local variables
dir = arcpy.GetInstallInfo(&quot;desktop&quot;)[&quot;InstallDir&quot;] translator = dir + &quot;Metadata/Translator/ESRI_ISO2ISO19139.xml&quot;
mxd = arcpy.mapping.MapDocument(&quot;CURRENT&quot;)
df = arcpy.mapping.ListDataFrames(mxd)[0] temp_path = &quot;C:/temp&quot;
for layer in arcpy.mapping.ListLayers(mxd, &quot;*&quot;, df[0]):
     if not layer.isGroupLayer:
         description_text = &quot;&quot;
         path = temp_path + '/' + layer.datasetName + '.xml'
         print path
         arcpy.ExportMetadata_conversion(layer.dataSource, translator, path)
         dom = xml.dom.minidom.parse(path)
         fields = ('abstract', 'purpose', 'credit')
         for field in fields:
             tags = dom.getElementsByTagName(field)
             print str( len(tags) ) + ' | ' + str( tags )
             if len(tags):
                 tag_string = tags[0].getElementsByTagName('gco:CharacterString')[0].childNodes[0].nodeValue
                 description_text = description_text + &quot;\n\n&quot; + field.capitalize() + &quot;:\n&quot; + tag_string
                 print description_text
                 layer.description = description_text
                   if field == 'credit':
                        layer.credit = tag_string
</code></pre></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../../../..';
    </script>
    <script data-main="../../../../mkdocs/js/search.js" src="../../../../mkdocs/js/require.js"></script>
    <script src="../../../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
